<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agora - Ancient Voices, Living Word</title>
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --background: #fafbfc;
            --text-primary: #333;
            --text-secondary: #2c3e50;
            --card-bg: white;
            --card-border: #e1e8ed;
            --accent-color: #667eea;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.07);
            --shadow-hover: 0 8px 15px rgba(0, 0, 0, 0.12);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: var(--background);
            color: var(--text-primary);
            line-height: 1.6;
        }

        /* Navigation */
        .nav {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--card-border);
            position: sticky;
            top: 0;
            z-index: 100;
            padding: 1rem 0;
        }

        .nav-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .nav-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
            color: var(--text-primary);
        }

        .nav-logo-icon {
            width: 40px;
            height: 40px;
            background: var(--primary-gradient);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .nav-logo-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .nav-logo-text {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .nav-links {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .nav-link {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .nav-link:hover {
            color: var(--accent-color);
        }

        /* Header */
        .header {
            background: var(--primary-gradient);
            color: white;
            padding: 4rem 0;
            text-align: center;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .logo {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            margin: 0 auto 2rem auto;
            overflow: hidden;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .header h1 {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .tagline {
            font-size: 1.3rem;
            opacity: 0.9;
            font-style: italic;
            margin-bottom: 2rem;
        }

        .header-description {
            font-size: 1.1rem;
            opacity: 0.85;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.7;
        }

        /* Main Content */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 4rem 2rem;
        }

        /* Input Section */
        .input-section {
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: var(--shadow);
            padding: 3rem;
            margin-bottom: 4rem;
            text-align: center;
        }

        .input-section h2 {
            color: var(--text-primary);
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .input-section p {
            color: var(--text-secondary);
            margin-bottom: 2rem;
            font-size: 1.1rem;
        }

        .search-container {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .search-input {
            flex: 1;
            padding: 1.25rem;
            border: 2px solid var(--card-border);
            border-radius: 12px;
            font-size: 1.1rem;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .search-input:focus {
            border-color: var(--accent-color);
        }

        .input-examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .example-category {
            background: #f8fafc;
            padding: 1.5rem;
            border-radius: 12px;
            border-left: 4px solid var(--accent-color);
        }

        .example-category h4 {
            color: var(--accent-color);
            font-size: 1rem;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .example-item {
            font-size: 0.9rem;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0.5rem 0;
            transition: color 0.2s ease;
            border-bottom: 1px solid #e2e8f0;
        }

        .example-item:last-child {
            border-bottom: none;
        }

        .example-item:hover {
            color: var(--accent-color);
        }

        /* Heralds Section */
        .heralds-section {
            margin-bottom: 4rem;
        }

        .section-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .section-header h2 {
            font-size: 2.5rem;
            color: var(--text-primary);
            margin-bottom: 1rem;
        }

        .section-header p {
            font-size: 1.2rem;
            color: var(--text-secondary);
            max-width: 700px;
            margin: 0 auto;
        }

        .heralds-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
        }

        .herald-card {
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .herald-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-hover);
        }

        .herald-card.john:hover { border-color: #10b981; }
        .herald-card.peter:hover { border-color: #ef4444; }
        .herald-card.barnabas:hover { border-color: #84cc16; }
        .herald-card.mary:hover { border-color: #3b82f6; }
        .herald-card.deborah:hover { border-color: #8b5cf6; }
        .herald-card.lydia:hover { border-color: #eab308; }

        .herald-card.coming-soon {
            opacity: 0.7;
        }

        .herald-card.coming-soon:hover {
            border-color: #9ca3af;
            transform: translateY(-2px);
        }

        .herald-card.selected {
            border-color: var(--accent-color) !important;
            transform: translateY(-4px);
            box-shadow: var(--shadow-hover);
        }

        .herald-header {
            padding: 2rem;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-bottom: 1px solid var(--card-border);
        }

        .herald-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .herald-subtitle {
            color: #8b5a9f;
            font-size: 1rem;
            font-weight: 600;
        }

        .herald-content {
            padding: 2rem;
        }

        .hebrew-name {
            background: #f1f5f9;
            padding: 0.75rem 1.25rem;
            border-radius: 8px;
            font-style: italic;
            color: #7c3f58;
            margin-bottom: 1.5rem;
            font-size: 1rem;
            font-weight: 500;
        }

        .herald-description {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            font-size: 1rem;
            line-height: 1.6;
        }

        .biblical-ref {
            font-size: 0.9rem;
            color: #64748b;
            border-top: 1px solid #e2e8f0;
            padding-top: 1.5rem;
            font-style: italic;
        }

        .herald-submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 1.25rem 2.5rem;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin: 2rem auto 0 auto;
            width: 200px;
            display: block;
            text-align: center;
            transition: all 0.3s ease;
        }

        .herald-submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .herald-submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Response Section */
        .response-section {
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: var(--shadow);
            padding: 3rem;
            margin-bottom: 3rem;
            display: none;
        }

        .response-header {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid var(--card-border);
        }

        .herald-avatar {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: var(--primary-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.75rem;
            color: white;
            font-weight: 700;
        }

        .response-meta h3 {
            color: var(--text-primary);
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .response-meta p {
            color: var(--text-secondary);
            font-size: 1rem;
        }

        .verse-display {
            background: #f1f5f9;
            border-left: 4px solid var(--accent-color);
            padding: 1.5rem;
            margin-bottom: 2rem;
            border-radius: 0 12px 12px 0;
        }

        .verse-text {
            font-style: italic;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
        }

        .verse-reference {
            font-size: 1rem;
            color: var(--accent-color);
            font-weight: 600;
        }

        .response-text {
            color: var(--text-primary);
            line-height: 1.8;
            font-size: 1.1rem;
        }

        .jesus-quote-section {
            background: linear-gradient(135deg, #fff7ed 0%, #fed7aa 100%);
            border: 2px solid #ea580c;
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
        }

        .jesus-quote-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            color: #9a3412;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .jesus-quote-text {
            font-style: italic;
            color: #7c2d12;
            margin-bottom: 1rem;
            font-size: 1.15rem;
            line-height: 1.6;
        }

        .jesus-quote-reference {
            color: #ea580c;
            font-weight: 600;
            text-align: right;
            font-size: 1rem;
        }

        .loading {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: var(--accent-color);
            justify-content: center;
            font-size: 1.1rem;
        }

        .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid #e2e8f0;
            border-top: 3px solid var(--accent-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Footer */
        .footer {
            background: var(--card-bg);
            border-top: 1px solid var(--card-border);
            padding: 3rem 0;
            text-align: center;
            color: var(--text-secondary);
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .footer-link {
            color: var(--accent-color);
            text-decoration: none;
            font-size: 1rem;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .footer-link:hover {
            color: var(--text-primary);
        }

        .footer-bottom {
            font-size: 0.9rem;
            color: #64748b;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-content {
                flex-direction: column;
                gap: 1rem;
            }

            .nav-links {
                gap: 1rem;
            }

            .header h1 {
                font-size: 2.5rem;
            }

            .search-container {
                flex-direction: column;
            }

            .input-examples {
                grid-template-columns: 1fr;
            }

            .heralds-grid {
                grid-template-columns: 1fr;
            }

            .response-header {
                flex-direction: column;
                text-align: center;
            }

            .footer-links {
                flex-direction: column;
                gap: 1.5rem;
            }

            .section-header h2 {
                font-size: 2rem;
            }

            .container {
                padding: 2rem 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-content">
            <a href="#" class="nav-logo">
                <div class="nav-logo-icon">
                    <img src="/HLogo.png" alt="Heralds Logo">
                </div>
                <span class="nav-logo-text">Agora</span>
            </a>
            <div class="nav-links">
                <a href="#" class="nav-link">Home</a>
                <a href="#" class="nav-link">References</a>
                <a href="#" class="nav-link">Herald Chat</a>
                <a href="#" class="nav-link">Learning</a>
                <a href="#" class="nav-link">About</a>
            </div>
        </div>
    </nav>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <img src="HLogo.png" alt="Agora Logo">
            </div>
            <h1>Agora</h1>
            <p class="header-description">
                Weclome to the Agora - the central meeting place in the cities of the Ancient Greek world. Here, you can meet Biblical "Heralds" (proclaimers and news-givers) who offer their unique perspectives on Scripture and life. 
                Engage with carefully crafted personalities that help you learn about Biblical truth and who will help reflect that truth into your daily life.
            </p>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <!-- Input Section -->
        <div class="input-section">
            <h2>Enter Your Query</h2>
            <p>Share a Bible verse (ex: "In the beginning..."), reference (ex: Genesis 1:1), spiritual question, or topic, then choose a biblical herald to provide their unique perspective.</p>
            
            <div class="search-container">
                <input type="text" class="search-input" placeholder="Enter Bible reference, question, topic, theme, etc..." id="searchInput">
            </div>
        </div>

        <!-- Heralds Section -->
        <div class="heralds-section">
            <div class="section-header">
                <h2>Meet Your Biblical Heralds</h2>
                <p>Six biblical characters ready to share wisdom, plus one more herald coming soon to complete the collection.</p>
            </div>

            <div class="heralds-grid">
                <!-- John -->
                <div class="herald-card john" data-herald="john">
                    <div class="herald-header">
                        <div class="herald-name">John</div>
                        <div class="herald-subtitle">The Beloved Disciple</div>
                    </div>
                    <div class="herald-content">
                        <div class="hebrew-name">Yochanan (◊ô◊ï◊ó◊†◊ü) - "God is gracious"</div>
                        <div class="herald-description">The beloved disciple who leaned on Jesus' chest at the Last Supper. Known for his deep love and profound spiritual insights, combining gentle care with thoughtful reflection.</div>
                        <div class="biblical-ref">John 13:23, John 19:26-27, 1 John 4:7-21</div>
                        <button class="herald-submit-btn" data-herald="john">Seek Wisdom</button>
                    </div>
                </div>

                <!-- Peter -->
                <div class="herald-card peter" data-herald="peter">
                    <div class="herald-header">
                        <div class="herald-name">Peter</div>
                        <div class="herald-subtitle">The Bold Fisherman</div>
                    </div>
                    <div class="herald-content">
                        <div class="hebrew-name">Kefa (◊õ◊ô◊§◊ê) - "Stone, Rock"</div>
                        <div class="herald-description">The bold fisherman who became the rock of the early church. Quick to speak and act, Peter leads with passionate conviction, combining bold challenge with encouraging uplift.</div>
                        <div class="biblical-ref">Matthew 16:13-20, Acts 2:14-41, 1 Peter 1:1-25</div>
                        <button class="herald-submit-btn" data-herald="peter">Seek Wisdom</button>
                    </div>
                </div>

                <!-- Barnabas -->
                <div class="herald-card barnabas" data-herald="barnabas">
                    <div class="herald-header">
                        <div class="herald-name">Barnabas</div>
                        <div class="herald-subtitle">Son of Encouragement</div>
                    </div>
                    <div class="herald-content">
                        <div class="hebrew-name">Bar-Nabba (◊ë◊®-◊†◊ë◊ê) - "Son of encouragement"</div>
                        <div class="herald-description">Called the "Son of Encouragement" by the apostles. He saw potential in Paul when others doubted and gave John Mark a second chance, blending gentle care with uplifting hope.</div>
                        <div class="biblical-ref">Acts 4:36-37, Acts 9:26-27, Acts 15:36-39</div>
                        <button class="herald-submit-btn" data-herald="barnabas">Seek Wisdom</button>
                    </div>
                </div>

                <!-- Mary of Bethany -->
                <div class="herald-card mary" data-herald="mary">
                    <div class="herald-header">
                        <div class="herald-name">Mary of Bethany</div>
                        <div class="herald-subtitle">The Contemplative Learner</div>
                    </div>
                    <div class="herald-content">
                        <div class="hebrew-name">Miriam (◊û◊®◊ô◊ù) - "Beloved"</div>
                        <div class="herald-description">The contemplative sister who chose to sit at Jesus' feet and learn. She understood the deeper significance of worship and sacrifice, combining thoughtful analysis with gentle care.</div>
                        <div class="biblical-ref">Luke 10:38-42, John 11:1-44, John 12:1-8</div>
                        <button class="herald-submit-btn" data-herald="mary">Seek Wisdom</button>
                    </div>
                </div>

                <!-- Deborah -->
                <div class="herald-card deborah" data-herald="deborah">
                    <div class="herald-header">
                        <div class="herald-name">Deborah</div>
                        <div class="herald-subtitle">Judge and Prophetess</div>
                    </div>
                    <div class="herald-content">
                        <div class="hebrew-name">Devorah (◊ì◊ë◊ï◊®◊î) - "Bee"</div>
                        <div class="herald-description">The judge and prophetess who led Israel to victory. She combined divine wisdom with decisive leadership in challenging times, merging bold challenge with thoughtful analysis.</div>
                        <div class="biblical-ref">Judges 4:1-24, Judges 5:1-31</div>
                        <button class="herald-submit-btn" data-herald="deborah">Seek Wisdom</button>
                    </div>
                </div>

                <!-- Lydia -->
                <div class="herald-card lydia" data-herald="lydia">
                    <div class="herald-header">
                        <div class="herald-name">Lydia</div>
                        <div class="herald-subtitle">The Hospitable Merchant</div>
                    </div>
                    <div class="herald-content">
                        <div class="hebrew-name">Lydia (ŒõœÖŒ¥ŒØŒ±) - "From Lydia, Noble one"</div>
                        <div class="herald-description">The God-fearing merchant whose heart the Lord opened to receive Paul's message. A successful businesswoman who used her resources to serve the early church with generous hospitality.</div>
                        <div class="biblical-ref">Acts 16:11-15, Acts 16:40</div>
                        <button class="herald-submit-btn" data-herald="lydia">Seek Wisdom</button>
                    </div>
                </div>

                <!-- Coming Soon - 7th Herald -->
                <div class="herald-card coming-soon">
                    <div class="herald-header">
                        <div class="herald-name">Coming Soon</div>
                        <div class="herald-subtitle">The 7th Herald</div>
                    </div>
                    <div class="herald-content">
                        <div class="hebrew-name">??? - "Mystery for now"</div>
                        <div class="herald-description">A seventh biblical character is being carefully crafted to complete our collection of diverse voices. Each herald brings unique wisdom from their biblical experience and personality.</div>
                        <div class="biblical-ref">The perfect herald is being chosen...</div>
                        <button class="herald-submit-btn" disabled style="background: #9ca3af; cursor: not-allowed;">Coming Soon</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Response Section -->
        <div class="response-section" id="responseSection">
            <!-- Dynamic content will be inserted here -->
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-links">
                <a href="#" class="footer-link">Home</a>
                <a href="#" class="footer-link">References</a>
                <a href="#" class="footer-link">Herald Chat</a>
                <a href="#" class="footer-link">Learning</a>
                <a href="#" class="footer-link">About</a>
                <a href="#" class="footer-link">Theological Approach</a>
                <a href="#" class="footer-link">Privacy Policy</a>
                <a href="#" class="footer-link">Terms of Service</a>
                <a href="#" class="footer-link">Feedback</a>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Agora. All rights reserved. Ancient Voices, Living Word.</p>
            </div>
        </div>
    </footer>

    <script>
        // ===== ENHANCED HERALD INTERACTION SYSTEM =====
        let selectedHerald = 'john';
        let isLoading = false;
        let userSession = {
            userId: 'user_' + Math.random().toString(36).substr(2, 9) + '_' + Date.now(),
            interactions: []
        };

        // Herald personalities (now including 7 heralds)
        const heralds = {
            john: {
                name: 'John',
                subtitle: 'The Beloved Disciple',
                colorProfile: { green: 9.0, blue: 7.5, red: 2.0, yellow: 6.0 },
                addressTerm: 'beloved',
                baseWordLimit: { min: 180, max: 230 }
            },
            peter: {
                name: 'Peter', 
                subtitle: 'The Bold Fisherman',
                colorProfile: { red: 9.5, yellow: 8.0, green: 5.5, blue: 3.0 },
                addressTerm: 'friend',
                baseWordLimit: { min: 200, max: 250 }
            },
            barnabas: {
                name: 'Barnabas',
                subtitle: 'Son of Encouragement', 
                colorProfile: { green: 9.0, yellow: 8.5, blue: 4.0, red: 2.5 },
                addressTerm: 'dear friend',
                baseWordLimit: { min: 190, max: 240 }
            },
            mary: {
                name: 'Mary of Bethany',
                subtitle: 'The Contemplative Learner',
                colorProfile: { blue: 9.0, green: 7.5, yellow: 3.5, red: 1.5 },
                addressTerm: 'dear one',
                baseWordLimit: { min: 170, max: 220 }
            },
            deborah: {
                name: 'Deborah',
                subtitle: 'Judge and Prophetess',
                colorProfile: { red: 8.5, blue: 8.0, green: 4.5, yellow: 3.0 },
                addressTerm: 'faithful one',
                baseWordLimit: { min: 185, max: 235 }
            },
            lydia: {
                name: 'Lydia',
                subtitle: 'The Hospitable Merchant',
                colorProfile: { yellow: 8.0, green: 7.5, blue: 6.0, red: 4.0 },
                addressTerm: 'dear sister',
                baseWordLimit: { min: 195, max: 245 }
            }
        };

        // ===== INPUT DETECTION WITH SLIDING SCALE =====
        function detectInputType(input) {
            const trimmed = input.trim().toLowerCase();
            const verseCount = countVerses(input);
            
            // Bible reference pattern
            const biblePattern = /^(Genesis|Gen|Exodus|Ex|Leviticus|Lev|Numbers|Num|Deuteronomy|Deut|Joshua|Josh|Judges|Judg|Ruth|1\s*Samuel|2\s*Samuel|1\s*Sam|2\s*Sam|1\s*Kings|2\s*Kings|1\s*Chron|2\s*Chron|Ezra|Nehemiah|Neh|Esther|Est|Job|Psalm|Ps|Proverbs|Prov|Ecclesiastes|Eccl|Song\s*of\s*Solomon|Song|Isaiah|Isa|Jeremiah|Jer|Lamentations|Lam|Ezekiel|Ezek|Daniel|Dan|Hosea|Joel|Amos|Obadiah|Obad|Jonah|Micah|Nahum|Habakkuk|Hab|Zephaniah|Zeph|Haggai|Hag|Zechariah|Zech|Malachi|Mal|Matthew|Matt|Mark|Luke|John|Acts|Romans|Rom|1\s*Corinthians|2\s*Corinthians|1\s*Cor|2\s*Cor|Galatians|Gal|Ephesians|Eph|Philippians|Phil|Colossians|Col|1\s*Thessalonians|2\s*Thessalonians|1\s*Thess|2\s*Thess|1\s*Timothy|2\s*Timothy|1\s*Tim|2\s*Tim|Titus|Philemon|Hebrews|Heb|James|1\s*Peter|2\s*Peter|1\s*Pet|2\s*Pet|1\s*John|2\s*John|3\s*John|Jude|Revelation|Rev)\s+\d+/i;
            
            if (biblePattern.test(input.trim())) {
                return { 
                    type: 'reference', 
                    reference: input.trim(),
                    complexity: verseCount > 1 ? 'multi-verse' : 'single-verse'
                };
            }
            
            // Common spiritual topics
            const topics = ['love', 'faith', 'prayer', 'hope', 'peace', 'wisdom', 'strength', 'forgiveness', 'courage', 'grace', 'joy', 'humility', 'patience', 'kindness', 'trust', 'protection', 'guidance', 'comfort', 'healing', 'provision'];
            for (const topic of topics) {
                if (trimmed.includes(topic) && input.length < 100) {
                    return { 
                        type: 'topic', 
                        topic: topic, 
                        query: input.trim(),
                        complexity: 'simple'
                    };
                }
            }
            
            // Direct scripture (longer text)
            if (input.length > 50) {
                return { 
                    type: 'scripture', 
                    text: input.trim(),
                    complexity: input.length > 200 ? 'extended' : 'moderate'
                };
            }
            
            // Default to general query
            return { 
                type: 'general', 
                query: input.trim(),
                complexity: input.length > 100 ? 'complex' : 'simple'
            };
        }

        function countVerses(input) {
            const versePattern = /\d+:\d+/g;
            const matches = input.match(versePattern);
            return matches ? matches.length : 1;
        }

        function calculateWordLimit(herald, inputType) {
            const base = herald.baseWordLimit;
            let multiplier = 1;
            
            switch(inputType.complexity) {
                case 'multi-verse':
                case 'extended':
                    multiplier = 1.5;
                    break;
                case 'complex':
                case 'moderate':
                    multiplier = 1.2;
                    break;
                case 'simple':
                default:
                    multiplier = 1;
                    break;
            }
            
            return {
                min: Math.floor(base.min * multiplier),
                max: Math.floor(base.max * multiplier)
            };
        }

        // ===== MAIN HERALD INTERACTION FUNCTION =====
        async function askHerald() {
            const searchInput = document.getElementById('searchInput');
            const input = searchInput ? searchInput.value.trim() : '';
            
            if (!input) {
                alert('Please enter a question, Bible verse, or topic first.');
                return;
            }

            const responseSection = document.getElementById('responseSection');
            const herald = heralds[selectedHerald];
            
            // Detect input type with complexity analysis
            const inputType = detectInputType(input);
            const wordLimit = calculateWordLimit(herald, inputType);
            console.log('Input type detected:', inputType, 'Word limit:', wordLimit);
            
            // Set loading state
            isLoading = true;
            updateLoadingState(true);
            
            // Show response section with loading
            if (responseSection) {
                responseSection.style.display = 'block';
                responseSection.innerHTML = getLoadingHTML(herald);
                responseSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }

            try {
                // Simulate herald response
                const mockResponse = await simulateHeraldResponse(herald, input, inputType, wordLimit);
                
                // Display response
                displayResponse(mockResponse);
                
            } catch (error) {
                console.error('Error:', error);
                displayError('Unable to connect to the herald. Please try again.');
            } finally {
                // Reset loading state
                isLoading = false;
                updateLoadingState(false);
            }
        }

        // ===== MOCK HERALD RESPONSE =====
        async function simulateHeraldResponse(herald, input, inputType, wordLimit) {
            // Simulate API delay
            await new Promise(resolve => setTimeout(resolve, 1500 + Math.random() * 1000));
            
            // Generate response based on herald personality
            let response = `${herald.addressTerm}, I see you've brought `;
            
            switch(inputType.type) {
                case 'reference':
                    response += `a beautiful Scripture passage to explore. `;
                    break;
                case 'scripture':
                    response += `the Word itself to examine together. `;
                    break;
                case 'topic':
                    response += `a question about ${inputType.topic} - a topic close to my heart. `;
                    break;
                default:
                    response += `a thoughtful question that deserves careful consideration. `;
            }
            
            // Add herald-specific perspective
            switch(herald.name.toLowerCase()) {
                case 'john':
                    response += `As one who walked closely with Jesus, I'm reminded of how His love transforms everything. Remember, beloved, that every verse, every question, every seeking heart is an invitation to experience God's love more deeply.`;
                    break;
                case 'peter':
                    response += `You know me - I'm not one to mince words! Friend, don't be afraid to dive deep into God's Word. He's big enough to handle our questions and strong enough to hold us through the answers.`;
                    break;
                case 'barnabas':
                    response += `How encouraging it is to see you seeking God's wisdom! Remember, dear friend, every step of seeking brings you closer to the heart of our loving Father.`;
                    break;
                case 'mary':
                    response += `I'm drawn into contemplation by your question. Dear one, let us sit together in the presence of the Word and allow His truth to wash over our souls.`;
                    break;
                case 'deborah':
                    response += `Your question calls for wisdom and discernment. Faithful one, let us seek the Lord's wisdom together and trust Him to illuminate the path forward.`;
                    break;
                case 'lydia':
                    response += `As one who has experienced God's provision in business and hospitality, I understand the practical side of faith. Dear sister, let me share how God's truth applies to our daily lives and relationships.`;
                    break;
            }
            
            // Add reference verses
            response += `\n\n*[Reference verses: ${inputType.reference || 'Psalm 119:105, 2 Timothy 3:16'} - Always verify Scripture in context]*`;
            
            return {
                success: true,
                heraldName: herald.name,
                response: response,
                inputType: inputType.type,
                wordCount: response.split(' ').length,
                wordLimit: wordLimit
            };
        }

        // ===== DISPLAY FUNCTIONS =====
        function displayResponse(data) {
            const responseSection = document.getElementById('responseSection');
            if (!responseSection) return;
            
            const herald = heralds[data.heraldName?.toLowerCase()] || heralds[selectedHerald];
            
            let content = `
                <div class="response-header">
                    <div class="herald-avatar">${herald.name.charAt(0)}</div>
                    <div class="response-meta">
                        <h3>${herald.name}</h3>
                        <p>${herald.subtitle}</p>
                    </div>
                </div>
                <div class="response-text">${formatText(data.response)}</div>
            `;

            responseSection.innerHTML = content;
        }

        function getLoadingHTML(herald) {
            return `
                <div class="response-header">
                    <div class="herald-avatar">${herald.name.charAt(0)}</div>
                    <div class="response-meta">
                        <h3>${herald.name}</h3>
                        <p>${herald.subtitle}</p>
                    </div>
                </div>
                <div class="loading" style="padding: 3rem;">
                    <div class="spinner"></div>
                    <span>${herald.name} is contemplating your query...</span>
                </div>
            `;
        }

        function updateLoadingState(loading) {
            document.querySelectorAll('.herald-submit-btn').forEach(btn => {
                btn.disabled = loading;
                if (loading) {
                    btn.innerHTML = '<div class="loading"><div class="spinner"></div>Seeking...</div>';
                } else {
                    btn.innerHTML = 'Seek Wisdom';
                }
            });
        }

        function displayError(message) {
            const responseSection = document.getElementById('responseSection');
            if (responseSection) {
                responseSection.innerHTML = `
                    <div class="response-header">
                        <div class="herald-avatar">!</div>
                        <div class="response-meta">
                            <h3>Unable to Connect</h3>
                            <p>Please try again</p>
                        </div>
                    </div>
                    <div class="response-text" style="color: #dc2626;">
                        ${message}
                    </div>
                `;
            }
        }

        function formatText(text) {
            return text.replace(/\n/g, '<br>').replace(/\*\[(.*?)\]\*/g, '<em style="color: #667eea;">$1</em>');
        }

        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', () => {
            // Set default herald selection
            const defaultCard = document.querySelector('.herald-card.john');
            if (defaultCard) {
                defaultCard.classList.add('selected');
            }
            
            // Herald selection handlers
            document.querySelectorAll('.herald-submit-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    
                    const input = document.getElementById('searchInput').value.trim();
                    if (!input) {
                        alert('Please enter a query first before selecting a herald.');
                        document.getElementById('searchInput').focus();
                        return;
                    }
                    
                    selectedHerald = btn.dataset.herald;
                    
                    // Visual selection feedback
                    document.querySelectorAll('.herald-card').forEach(c => c.classList.remove('selected'));
                    btn.closest('.herald-card').classList.add('selected');
                    
                    askHerald();
                });
            });

            // Herald card click for selection only
            document.querySelectorAll('.herald-card').forEach(card => {
                card.addEventListener('click', () => {
                    document.querySelectorAll('.herald-card').forEach(c => c.classList.remove('selected'));
                    card.classList.add('selected');
                    selectedHerald = card.dataset.herald;
                });
            });

            // Example click handlers - REMOVED since examples section was removed
            // document.querySelectorAll('.example-item').forEach(item => {
            //     item.addEventListener('click', () => {
            //         const searchInput = document.getElementById('searchInput');
            //         if (searchInput) {
            //             searchInput.value = item.dataset.example;
            //         }
            //     });
            // });

            // Enter key handling
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !isLoading) {
                        const input = searchInput.value.trim();
                        if (input) {
                            const heraldsSection = document.querySelector('.heralds-section');
                            if (heraldsSection) {
                                heraldsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                            }
                        }
                    }
                });
            }

            console.log('üèõÔ∏è Agora initialized - Ancient Voices, Living Word');
            console.log('üë• 6 Biblical Heralds ready to serve (Luke reserved for Lyceum)');
            console.log('üéØ Clean, focused landing page complete');
        });
    </script>
</body>
</html>
