<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heralds - Ancient Voices, Living Word</title>
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --background: #fafbfc;
            --text-primary: #333;
            --text-secondary: #2c3e50;
            --card-bg: white;
            --card-border: #e1e8ed;
            --accent-color: #667eea;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.07);
            --shadow-hover: 0 8px 15px rgba(0, 0, 0, 0.12);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: var(--background);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .header {
            background: var(--primary-gradient);
            color: white;
            padding: 2rem 0;
            box-shadow: var(--shadow);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .tagline {
            font-size: 1.2rem;
            opacity: 0.9;
            font-style: italic;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .intro {
            text-align: center;
            margin-bottom: 3rem;
        }

        .intro p {
            font-size: 1.1rem;
            color: var(--text-secondary);
            max-width: 800px;
            margin: 0 auto;
        }

        .input-section {
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .input-section h2 {
            color: var(--text-primary);
            margin-bottom: 1rem;
            text-align: center;
        }

        .search-container {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .search-input {
            flex: 1;
            padding: 1rem;
            border: 2px solid var(--card-border);
            border-radius: 8px;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .search-input:focus {
            border-color: var(--accent-color);
        }

        .ask-button {
            background: var(--primary-gradient);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .ask-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .ask-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .input-examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .example-category {
            background: #f8fafc;
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid var(--accent-color);
        }

        .example-category h4 {
            color: var(--accent-color);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .example-item {
            font-size: 0.8rem;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0.25rem 0;
            transition: color 0.2s ease;
        }

        .example-item:hover {
            color: var(--accent-color);
        }

        .heralds-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .herald-card {
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .herald-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-hover);
        }

        .herald-card.john:hover { border-color: #10b981; }
        .herald-card.peter:hover { border-color: #ef4444; }
        .herald-card.barnabas:hover { border-color: #84cc16; }
        .herald-card.mary:hover { border-color: #3b82f6; }
        .herald-card.deborah:hover { border-color: #8b5cf6; }

        .herald-card.selected {
            border-color: var(--accent-color) !important;
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .herald-header {
            padding: 1.5rem;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-bottom: 1px solid var(--card-border);
        }

        .herald-name {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .herald-subtitle {
            color: var(--accent-color);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .herald-content {
            padding: 1.5rem;
        }

        .herald-description {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            font-size: 0.95rem;
        }

        .hebrew-name {
            background: #f1f5f9;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-style: italic;
            color: var(--accent-color);
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .biblical-ref {
            font-size: 0.8rem;
            color: #64748b;
            border-top: 1px solid #e2e8f0;
            padding-top: 1rem;
        }

        .herald-submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 1.2rem 2.5rem;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin: 1.5rem auto 0 auto;
            width: 150px;
            display: block;
            text-align: center;
            transition: all 0.3s ease;
        }

        .herald-submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .herald-submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .response-section {
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 2rem;
            margin-bottom: 2rem;
            display: none;
        }

        .response-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--card-border);
        }

        .herald-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            font-weight: 600;
        }

        .response-meta h3 {
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .response-meta p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .verse-display {
            background: #f1f5f9;
            border-left: 4px solid var(--accent-color);
            padding: 1rem;
            margin-bottom: 1.5rem;
            border-radius: 0 8px 8px 0;
        }

        .verse-text {
            font-style: italic;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .verse-reference {
            font-size: 0.9rem;
            color: var(--accent-color);
            font-weight: 600;
        }

        .response-text {
            color: var(--text-primary);
            line-height: 1.7;
            font-size: 1rem;
        }

        .easter-egg {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 2px solid #f59e0b;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .easter-egg-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            color: #92400e;
        }

        .easter-egg-title {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .easter-egg-content {
            color: #451a03;
            line-height: 1.6;
        }

        .easter-egg-image {
            max-width: 200px;
            border-radius: 8px;
            margin: 1rem 0;
        }

        .hebrew-result {
            background: #eff6ff;
            border: 2px solid #3b82f6;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .hebrew-name-display {
            font-size: 1.3rem;
            font-weight: 600;
            color: #1e40af;
            margin-bottom: 0.5rem;
        }

        .hebrew-meaning {
            color: #1e3a8a;
            margin-bottom: 1rem;
        }

        .concordance-results {
            display: grid;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .concordance-verse {
            background: #f8fafc;
            padding: 0.75rem;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            border-left: 3px solid var(--accent-color);
        }

        .concordance-verse:hover {
            background: #e2e8f0;
        }

        .recommendation-banner {
            background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
            border: 2px solid #10b981;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .recommendation-text {
            color: #065f46;
            margin-bottom: 0.5rem;
        }

        .try-herald-btn {
            background: #10b981;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }

        .loading {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--accent-color);
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid #e2e8f0;
            border-top: 2px solid var(--accent-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .footer {
            background: var(--card-bg);
            border-top: 1px solid var(--card-border);
            padding: 2rem 0;
            text-align: center;
            color: var(--text-secondary);
            margin-top: 3rem;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 1rem;
        }

        .footer-link {
            color: var(--accent-color);
            text-decoration: none;
            font-size: 0.9rem;
        }

        .footer-link:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .search-container {
                flex-direction: column;
            }
            
            .input-examples {
                grid-template-columns: 1fr;
            }
            
            .response-header {
                flex-direction: column;
                text-align: center;
            }
            
            .footer-links {
                flex-direction: column;
                gap: 1rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <h1>Heralds</h1>
            <p class="tagline">Ancient Voices, Living Word</p>
        </div>
    </header>

    <div class="container">
        <div class="intro" style="max-width: 800px; margin: 0 auto; text-align: left; line-height: 1.8;">
            <p style="margin-bottom: 0.5rem;">Meet 5 Biblical heralds - messengers with important proclamations</p>
            <p style="margin-bottom: 0.5rem;">Engage with carefully crafted, unique personalities</p>
            <p style="margin-bottom: 0.5rem;">Enrich your Biblical experience with resources like Hebrew name meanings, concordance, and indexed verses</p>
            <p style="margin-bottom: 0.5rem;">Seek insights to help you grow closer to the Authentic Jesus</p>
        </div>

        <div class="input-section">
            <h2>Enter Your Query</h2>
            <p style="text-align: center; color: var(--text-secondary); margin-bottom: 1.5rem;">
                Enter a Bible verse, Hebrew name, or question below, then scroll down to select a Herald who will provide their unique perspective.
            </p>
            <div class="search-container">
                <input type="text" class="search-input" placeholder="Enter Bible reference, Hebrew name, topic, or question..." id="searchInput">
            </div>
        </div>

        <div style="text-align: center; margin: 2rem 0;">
            <h2 style="color: var(--text-primary); margin-bottom: 0.5rem;">Choose Your Herald</h2>
            <p style="color: var(--text-secondary);">Select a Biblical character to provide their unique perspective on your query.</p>
        </div>

        <div class="heralds-grid">
            <div class="herald-card john" data-herald="john">
                <div class="herald-header">
                    <div class="herald-name">John</div>
                    <div class="herald-subtitle">The Beloved Disciple</div>
                </div>
                <div class="herald-content">
                    <div class="hebrew-name">Yochanan (◊ô◊ï◊ó◊†◊ü) - "God is gracious"</div>
                    <div class="herald-description">The beloved disciple who leaned on Jesus' chest at the Last Supper. Known for his deep love and profound spiritual insights, combining gentle care with thoughtful reflection.</div>
                    <div class="biblical-ref">John 13:23, John 19:26-27, 1 John 4:7-21</div>
                    <button class="herald-submit-btn" data-herald="john">Submit</button>
                </div>
            </div>

            <div class="herald-card peter" data-herald="peter">
                <div class="herald-header">
                    <div class="herald-name">Peter</div>
                    <div class="herald-subtitle">The Bold Fisherman</div>
                </div>
                <div class="herald-content">
                    <div class="hebrew-name">Kefa (◊õ◊ô◊§◊ê) - "Stone, Rock"</div>
                    <div class="herald-description">The bold fisherman who became the rock of the early church. Quick to speak and act, Peter leads with passionate conviction, combining bold challenge with encouraging uplift.</div>
                    <div class="biblical-ref">Matthew 16:13-20, Acts 2:14-41, 1 Peter 1:1-25</div>
                    <button class="herald-submit-btn" data-herald="peter">Submit</button>
                </div>
            </div>

            <div class="herald-card barnabas" data-herald="barnabas">
                <div class="herald-header">
                    <div class="herald-name">Barnabas</div>
                    <div class="herald-subtitle">Son of Encouragement</div>
                </div>
                <div class="herald-content">
                    <div class="hebrew-name">Bar-Nabba (◊ë◊®-◊†◊ë◊ê) - "Son of encouragement"</div>
                    <div class="herald-description">Called the "Son of Encouragement" by the apostles. He saw potential in Paul when others doubted and gave John Mark a second chance, blending gentle care with uplifting hope.</div>
                    <div class="biblical-ref">Acts 4:36-37, Acts 9:26-27, Acts 15:36-39</div>
                    <button class="herald-submit-btn" data-herald="barnabas">Submit</button>
                </div>
            </div>

            <div class="herald-card mary" data-herald="mary">
                <div class="herald-header">
                    <div class="herald-name">Mary of Bethany</div>
                    <div class="herald-subtitle">The Contemplative Learner</div>
                </div>
                <div class="herald-content">
                    <div class="hebrew-name">Miriam (◊û◊®◊ô◊ù) - "Beloved"</div>
                    <div class="herald-description">The contemplative sister who chose to sit at Jesus' feet and learn. She understood the deeper significance of worship and sacrifice, combining thoughtful analysis with gentle care.</div>
                    <div class="biblical-ref">Luke 10:38-42, John 11:1-44, John 12:1-8</div>
                    <button class="herald-submit-btn" data-herald="mary">Submit</button>
                </div>
            </div>

            <div class="herald-card deborah" data-herald="deborah">
                <div class="herald-header">
                    <div class="herald-name">Deborah</div>
                    <div class="herald-subtitle">Judge and Prophetess</div>
                </div>
                <div class="herald-content">
                    <div class="hebrew-name">Devorah (◊ì◊ë◊ï◊®◊î) - "Bee"</div>
                    <div class="herald-description">The judge and prophetess who led Israel to victory. She combined divine wisdom with decisive leadership in challenging times, merging bold challenge with thoughtful analysis.</div>
                    <div class="biblical-ref">Judges 4:1-24, Judges 5:1-31</div>
                    <button class="herald-submit-btn" data-herald="deborah">Submit</button>
                </div>
            </div>
        </div>

        <div class="response-section" id="responseSection">
            <!-- Dynamic content will be inserted here -->
        </div>

        <div class="references-tools-section">
            <h2 style="text-align: center; color: var(--text-primary); margin-bottom: 1rem;">References & Tools</h2>
            
            <!-- Interactive Concordance -->
            <div class="concordance-tool" style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem; border-left: 4px solid var(--accent-color);">
                <h3 style="color: var(--accent-color); margin-bottom: 1rem;">üìö Interactive Concordance</h3>
                <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                    <input type="text" id="concordanceSearch" placeholder="Search topics: love, faith, prayer, forgiveness..." 
                           style="flex: 1; padding: 0.75rem; border: 2px solid var(--card-border); border-radius: 6px; font-size: 0.9rem;">
                    <button id="concordanceBtn" onclick="searchConcordance()" 
                            style="background: var(--accent-color); color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 6px; cursor: pointer; font-weight: 600;">Search</button>
                </div>
                <div id="concordanceResults" style="display: none;">
                    <!-- Results will appear here -->
                </div>
                <div id="concordanceTopics" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 0.5rem; margin-top: 1rem;">
                    <!-- Topic buttons will be added here -->
                </div>
            </div>
            
            <div class="input-examples">
                <div class="example-category">
                    <h4>üìñ Bible References</h4>
                    <div class="example-item" data-example="John 3:16">John 3:16</div>
                    <div class="example-item" data-example="Psalm 23">Psalm 23</div>
                    <div class="example-item" data-example="1 Corinthians 13:4-7">1 Corinthians 13:4-7</div>
                    <div class="example-item" data-example="Romans 8:28">Romans 8:28</div>
                </div>
                
                <div class="example-category">
                    <h4>üî§ Hebrew Names</h4>
                    <div class="example-item" data-example="yochanan">Yochanan</div>
                    <div class="example-item" data-example="kefa">Kefa</div>
                    <div class="example-item" data-example="miriam">Miriam</div>
                    <div class="example-item" data-example="shalom">Shalom</div>
                </div>
                
                <div class="example-category">
                    <h4>‚ú® Names of God</h4>
                    <div class="example-item" data-example="elohim">Elohim</div>
                    <div class="example-item" data-example="jehovah-jireh">Jehovah-Jireh</div>
                    <div class="example-item" data-example="jehovah-rapha">Jehovah-Rapha</div>
                    <div class="example-item" data-example="el-shaddai">El-Shaddai</div>
                </div>
                
                <div class="example-category">
                    <h4>üí≠ Topics & Questions</h4>
                    <div class="example-item" data-example="love">Love</div>
                    <div class="example-item" data-example="faith">Faith</div>
                    <div class="example-item" data-example="How do I find peace?">How do I find peace?</div>
                    <div class="example-item" data-example="prayer">Prayer</div>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-links">
            <a href="feedback.html" class="footer-link">Support & Feedback</a>
            <a href="privacy.html" class="footer-link">Privacy Policy</a>
            <a href="terms.html" class="footer-link">Terms of Service</a>
            <a href="about.html" class="footer-link">About</a>
        </div>
        <p>&copy; 2024 Heralds. All rights reserved.</p>
    </footer>

    <script>
        let selectedHerald = 'john'; // Default herald
        let isLoading = false;

        // Smart Input Detection Function (enhanced for Names of God)
        function detectInputType(input) {
            const trimmed = input.trim().toLowerCase();
            
            // Names of God (highest priority)
            const namesOfGod = ['elohim', 'yahweh', 'yhwh', 'adonai', 'el-shaddai', 'el-roi', 'el-olam', 'el-elyon', 'jehovah-jireh', 'jehovah-rapha', 'jehovah-nissi', 'jehovah-shalom', 'jehovah-rohi', 'jehovah-tsidkenu', 'jehovah-shammah', 'jehovah-sabaoth', 'abba', 'hashem'];
            
            for (const name of namesOfGod) {
                if (trimmed.includes(name)) {
                    return { 
                        type: 'names_of_god', 
                        name: name,
                        input: trimmed 
                    };
                }
            }
            
            // Hebrew names for Easter eggs
            const easterEggNames = {
                'yochanan': 'john', 'yohanan': 'john',
                'kefa': 'peter', 'cephas': 'peter', 'kepha': 'peter',
                'bar-nabba': 'barnabas', 'barnabba': 'barnabas',
                'miriam': 'mary',
                'devorah': 'deborah', 'dvorah': 'deborah'
            };
            
            // Check for Easter egg Hebrew names
            for (const [hebrewName, herald] of Object.entries(easterEggNames)) {
                if (trimmed.includes(hebrewName)) {
                    return { 
                        type: 'easter_egg', 
                        herald: herald,
                        hebrewName: hebrewName,
                        input: trimmed 
                    };
                }
            }
            
            // Check for Bible reference pattern
            const biblePattern = /^(Genesis|Gen|Exodus|Ex|Leviticus|Lev|Numbers|Num|Deuteronomy|Deut|Joshua|Josh|Judges|Judg|Ruth|1\s*Samuel|2\s*Samuel|1\s*Sam|2\s*Sam|1\s*Kings|2\s*Kings|1\s*Chron|2\s*Chron|Ezra|Nehemiah|Neh|Esther|Est|Job|Psalm|Ps|Proverbs|Prov|Ecclesiastes|Eccl|Song\s*of\s*Solomon|Song|Isaiah|Isa|Jeremiah|Jer|Lamentations|Lam|Ezekiel|Ezek|Daniel|Dan|Hosea|Joel|Amos|Obadiah|Obad|Jonah|Micah|Nahum|Habakkuk|Hab|Zephaniah|Zeph|Haggai|Hag|Zechariah|Zech|Malachi|Mal|Matthew|Matt|Mark|Luke|John|Acts|Romans|Rom|1\s*Corinthians|2\s*Corinthians|1\s*Cor|2\s*Cor|Galatians|Gal|Ephesians|Eph|Philippians|Phil|Colossians|Col|1\s*Thessalonians|2\s*Thessalonians|1\s*Thess|2\s*Thess|1\s*Timothy|2\s*Timothy|1\s*Tim|2\s*Tim|Titus|Philemon|Hebrews|Heb|James|1\s*Peter|2\s*Peter|1\s*Pet|2\s*Pet|1\s*John|2\s*John|3\s*John|Jude|Revelation|Rev)\s+\d+/i;
            
            if (biblePattern.test(input.trim())) {
                return { type: 'reference', reference: input.trim() };
            }
            
            // Check for Hebrew names (non-Easter egg)
            const hebrewNames = ['yeshua', 'david', 'moses', 'abraham', 'sarah', 'rachel', 'ruth', 'esther', 'daniel', 'samuel', 'shalom', 'hesed', 'tsedek', 'emunah'];
            if (trimmed.length <= 20) {
                for (const name of hebrewNames) {
                    if (trimmed.includes(name)) {
                        return { type: 'hebrew_name', name: name };
                    }
                }
            }
            
            // Check for concordance topics
            const topics = ['love', 'faith', 'prayer', 'hope', 'peace', 'wisdom', 'strength', 'forgiveness', 'courage', 'grace', 'joy', 'humility', 'patience', 'kindness', 'trust', 'protection', 'guidance', 'comfort', 'healing', 'provision'];
            for (const topic of topics) {
                if (trimmed.includes(topic) && input.length < 100) {
                    return { type: 'concordance', topic: topic, query: input.trim() };
                }
            }
            
            // Check for direct scripture (longer text)
            if (input.length > 50) {
                return { type: 'scripture', text: input.trim() };
            }
            
            // Default to general interpretation
            return { type: 'general', query: input.trim() };
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            // Set default herald selection
            const defaultCard = document.querySelector('.herald-card.john');
            if (defaultCard) {
                defaultCard.classList.add('selected');
            }
            
            // Herald selection handlers for submit buttons
            document.querySelectorAll('.herald-submit-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation(); // Prevent card click
                    
                    const input = document.getElementById('searchInput').value.trim();
                    if (!input) {
                        alert('Please enter a query first before selecting a herald.');
                        document.getElementById('searchInput').focus();
                        return;
                    }
                    
                    selectedHerald = btn.dataset.herald;
                    
                    // Visual selection feedback
                    document.querySelectorAll('.herald-card').forEach(c => c.classList.remove('selected'));
                    btn.closest('.herald-card').classList.add('selected');
                    
                    askHerald();
                });
            });

            // Keep card hover for visual feedback but remove click functionality
            document.querySelectorAll('.herald-card').forEach(card => {
                card.addEventListener('click', () => {
                    // Just visual selection, no functionality
                    document.querySelectorAll('.herald-card').forEach(c => c.classList.remove('selected'));
                    card.classList.add('selected');
                    selectedHerald = card.dataset.herald;
                });
            });

            // Example click handlers
            document.querySelectorAll('.example-item').forEach(item => {
                item.addEventListener('click', () => {
                    const searchInput = document.getElementById('searchInput');
                    if (searchInput) {
                        searchInput.value = item.dataset.example;
                        // Optionally auto-trigger with default herald
                        // askHerald();
                    }
                });
            });

            // Search input handlers - Enter key should prompt to select herald
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !isLoading) {
                        const input = searchInput.value.trim();
                        if (input) {
                            // Scroll to heralds section
                            const heraldsGrid = document.querySelector('.heralds-grid');
                            if (heraldsGrid) {
                                heraldsGrid.scrollIntoView({ behavior: 'smooth', block: 'start' });
                                
                                // Flash the herald section to draw attention
                                const heraldsSection = heraldsGrid.parentElement;
                                if (heraldsSection) {
                                    heraldsSection.style.backgroundColor = '#f0f9ff';
                                    setTimeout(() => {
                                        heraldsSection.style.backgroundColor = '';
                                    }, 1000);
                                }
                            }
                        }
                    }
                });
            }

            // Keyboard shortcut for quick search
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey && e.key === '/') {
                    e.preventDefault();
                    const searchInput = document.getElementById('searchInput');
                    if (searchInput) {
                        searchInput.focus();
                    }
                }
            });

            // Easter egg hints with Names of God
            const easterEggHints = [
                "Try searching for Hebrew names like 'yochanan' or 'kefa'...",
                "Discover the Names of God like 'elohim' or 'jehovah-jireh'...",
                "Explore 'jehovah-rapha' for prayer about healing...",
                "Some names unlock special messages from the heralds..."
            ];

            let hintCounter = 0;
            setInterval(() => {
                const input = document.getElementById('searchInput');
                if (input && !input.value && !isLoading) {
                    hintCounter = (hintCounter + 1) % easterEggHints.length;
                    input.placeholder = easterEggHints[hintCounter];
                    
                    setTimeout(() => {
                        if (!input.value) {
                            input.placeholder = "Enter Bible reference, Hebrew name, topic, or question...";
                        }
                    }, 3000);
                }
            }, 15000);
        });

        // Main function to ask herald
        async function askHerald() {
            const searchInput = document.getElementById('searchInput');
            const input = searchInput ? searchInput.value.trim() : '';
            
            if (!input) return;

            const responseSection = document.getElementById('responseSection');
            
            // Detect input type using smart detection
            const inputType = detectInputType(input);
            console.log('Input type detected:', inputType);
            
            // Set loading state
            isLoading = true;
            
            // Disable all submit buttons during loading
            document.querySelectorAll('.herald-submit-btn').forEach(btn => {
                btn.disabled = true;
                btn.innerHTML = '<div class="loading"><div class="spinner"></div>Seeking wisdom...</div>';
            });
            
            // Show response section with loading
            if (responseSection) {
                responseSection.style.display = 'block';
                responseSection.innerHTML = `
                    <div class="loading" style="justify-content: center; padding: 2rem;">
                        <div class="spinner"></div>
                        <span>The herald is contemplating your query...</span>
                    </div>
                `;
            }

            try {
                const response = await fetch('/api/heralds', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        herald: selectedHerald,
                        input: input,
                        userId: generateUserId()
                    })
                });

                const data = await response.json();
                
                if (data.success) {
                    displayResponse(data);
                    
                    // Auto-scroll to response for all devices
                    setTimeout(() => {
                        if (responseSection) {
                            responseSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                    }, 100);
                } else {
                    displayError(data.error || 'An error occurred');
                }
            } catch (error) {
                console.error('Error:', error);
                displayError('Unable to connect to the herald. Please try again.');
            } finally {
                // Reset loading state
                isLoading = false;
                document.querySelectorAll('.herald-submit-btn').forEach(btn => {
                    btn.disabled = false;
                    btn.textContent = 'Submit';
                });
            }
        }

        // Display response based on type
        function displayResponse(data) {
            const responseSection = document.getElementById('responseSection');
            if (!responseSection) return;
            
            let content = '';

            // Response header
            const heraldInfo = getHeraldInfo(data.heraldName || selectedHerald);
            content += `
                <div class="response-header">
                    <div class="herald-avatar">${heraldInfo.initial}</div>
                    <div class="response-meta">
                        <h3>${data.heraldName}</h3>
                        <p>${heraldInfo.subtitle}</p>
                    </div>
                </div>
            `;

            // Handle different response types
            switch (data.type) {
                case 'easter_egg':
                    content += displayEasterEgg(data);
                    break;
                case 'names_of_god':
                    content += displayNamesOfGod(data);
                    break;
                case 'hebrew_name':
                    content += displayHebrewName(data);
                    break;
                case 'hebrew_search':
                    content += displayHebrewSearch(data);
                    break;
                case 'concordance':
                    content += displayConcordance(data);
                    break;
                case 'interpretation':
                default:
                    content += displayInterpretation(data);
                    break;
            }

            // Add recommendation if present
            if (data.recommendation) {
                content += displayRecommendation(data.recommendation);
            }

            responseSection.innerHTML = content;
        }

        // Display Easter Egg
        function displayEasterEgg(data) {
            let content = `
                <div class="easter-egg">
                    <div class="easter-egg-header">
                        <span>ü•ö</span>
                        <span class="easter-egg-title">${data.easterEgg.title}</span>
                        <span>üéâ</span>
                    </div>
                    <div class="easter-egg-content">
                        ${formatText(data.easterEgg.text)}
                    </div>
            `;
            
            if (data.easterEgg.image) {
                content += `<img src="${data.easterEgg.image}" alt="${data.easterEgg.title}" class="easter-egg-image">`;
            }
            
            content += '</div>';
            return content;
        }

        // Display Names of God
        function displayNamesOfGod(data) {
            return `
                <div class="names-of-god-result">
                    <div class="names-of-god-header">
                        <span class="holy-icon">‚ú®</span>
                        <div class="names-of-god-title">${data.hebrew} ‚Üí ${data.english}</div>
                    </div>
                    <div class="names-of-god-meaning"><strong>Meaning:</strong> ${data.meaning}</div>
                    <div class="names-of-god-context">${data.context}</div>
                    <div class="prayer-application">
                        <strong>In Prayer:</strong> This name reveals God's character for specific needs. When you pray to ${data.english}, you're approaching the aspect of God that ${data.meaning.toLowerCase()}. Let this name guide and focus your prayers.
                    </div>
                </div>
            `;
        }

        // Display Hebrew Name
        function displayHebrewName(data) {
            return `
                <div class="hebrew-result">
                    <div class="hebrew-name-display">${data.hebrew} ‚Üí ${data.english}</div>
                    <div class="hebrew-meaning"><strong>Meaning:</strong> ${data.meaning}</div>
                    <div><strong>Context:</strong> ${data.context}</div>
                </div>
            `;
        }

        // Display Hebrew Search Results
        function displayHebrewSearch(data) {
            let content = `<div class="hebrew-result">
                <div class="hebrew-name-display">Hebrew Names for "${data.query}"</div>
            `;
            
            data.results.forEach(result => {
                const resultClass = result.sacred ? 'names-of-god-result' : 'hebrew-search-item';
                const icon = result.sacred ? '‚ú®' : 'üìú';
                
                content += `
                    <div class="${resultClass}" style="margin: 1rem 0; padding: 1rem; background: ${result.sacred ? '#fef9e7' : 'white'}; border-radius: 6px; border-left: 4px solid ${result.sacred ? '#d97706' : '#3b82f6'};">
                        <strong>${icon} ${result.hebrew} ‚Üí ${result.english}</strong><br>
                        <em>${result.meaning}</em><br>
                        <small>${result.context}</small>
                        ${result.sacred ? '<br><small style="color: #d97706; font-weight: 600;">Name of God - for prayer and worship</small>' : ''}
                    </div>
                `;
            });
            
            content += '</div>';
            return content;
        }

        // Display Concordance
        function displayConcordance(data) {
            let content = `
                <div class="hebrew-result">
                    <div class="hebrew-name-display">Verses about "${data.topic}"</div>
                    <div class="concordance-results">
            `;
            
            data.concordance.forEach(verse => {
                content += `
                    <div class="concordance-verse" onclick="searchVerse('${verse.reference}')">
                        ${verse.reference}
                    </div>
                `;
            });
            
            content += '</div></div>';
            return content;
        }

        // Display Interpretation
        function displayInterpretation(data) {
            let content = '';
            
            // Show verse if available
            if (data.verseText) {
                content += `
                    <div class="verse-display">
                        <div class="verse-text">"${data.verseText.text}"</div>
                        <div class="verse-reference">${data.verseText.reference} (${data.verseText.translation})</div>
                    </div>
                `;
            }
            
            // Show response
            content += `<div class="response-text">${formatText(data.response)}</div>`;
            
            return content;
        }

        // Display Recommendation
        function displayRecommendation(recommendation) {
            return `
                <div class="recommendation-banner">
                    <div class="recommendation-text">${recommendation.message}</div>
                    <button class="try-herald-btn" onclick="switchToHerald('${recommendation.recommendedHerald}')">
                        Try ${getHeraldInfo(recommendation.recommendedHerald).name}
                    </button>
                </div>
            `;
        }

        // Helper functions
        function formatText(text) {
            return text.replace(/\n/g, '<br>').replace(/\*\[(.*?)\]\*/g, '<em style="color: #667eea;">$1</em>');
        }

        function getHeraldInfo(heraldName) {
            const heralds = {
                john: { name: 'John', subtitle: 'The Beloved Disciple', initial: 'J' },
                peter: { name: 'Peter', subtitle: 'The Bold Fisherman', initial: 'P' },
                barnabas: { name: 'Barnabas', subtitle: 'Son of Encouragement', initial: 'B' },
                mary: { name: 'Mary of Bethany', subtitle: 'The Contemplative Learner', initial: 'M' },
                deborah: { name: 'Deborah', subtitle: 'Judge and Prophetess', initial: 'D' }
            };
            return heralds[heraldName.toLowerCase()] || heralds.john;
        }

        function searchVerse(reference) {
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.value = reference;
                askHerald();
            }
        }

        function switchToHerald(heraldName) {
            // Update selected herald
            selectedHerald = heraldName;
            
            // Update visual selection
            document.querySelectorAll('.herald-card').forEach(card => {
                card.classList.remove('selected');
                if (card.dataset.herald === heraldName) {
                    card.classList.add('selected');
                    card.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            });
            
            // Re-ask with new herald
            askHerald();
        }

        function displayError(message) {
            const responseSection = document.getElementById('responseSection');
            if (responseSection) {
                responseSection.innerHTML = `
                    <div class="response-header">
                        <div class="herald-avatar">!</div>
                        <div class="response-meta">
                            <h3>Unable to Connect</h3>
                            <p>Please try again</p>
                        </div>
                    </div>
                    <div class="response-text" style="color: #dc2626;">
                        ${message}
                    </div>
                `;
            }
        }

        // In-memory storage for user session
        let userSession = {
            userId: 'user_' + Math.random().toString(36).substr(2, 9) + '_' + Date.now(),
            interactions: []
        };

        function generateUserId() {
            return userSession.userId;
        }

        // Analytics for understanding user behavior (privacy-conscious)
        function trackInteraction(type, data) {
            // Simple in-memory analytics - no external tracking
            userSession.interactions.push({
                type,
                data,
                timestamp: Date.now(),
                herald: selectedHerald
            });
            
            // Keep only last 50 interactions
            if (userSession.interactions.length > 50) {
                userSession.interactions.splice(0, userSession.interactions.length - 50);
            }
        }

        // Add smooth scroll behavior
        document.documentElement.style.scrollBehavior = 'smooth';

        // Placeholder functions for concordance
        function searchConcordance() {
            console.log('Concordance search not yet implemented');
        }

        // Console welcome message
        console.log('üéØ Biblical Heralds - Ancient Voices, Living Word');
        console.log('üìä Enhanced Features: Hebrew Names Database, Names of God, Easter Eggs, Smart Input Detection, Color Psychology');
        console.log('üîç Try searching for: yochanan, kefa, miriam, devorah, or bar-nabba for special Easter eggs!');
        console.log('‚ú® Names of God: elohim, yahweh, jehovah-jireh, jehovah-rapha, el-shaddai for prayer focus');
        console.log('üìñ Bible references, topics like "love" or "faith", and questions all supported');
    </script>
</body>
</html>
